<!DOCTYPE html>
<html>
<head>
  <script type="application/x-javascript;version=1.8" src="framework.js"></script>
  <script type="application/x-javascript;version=1.8" src="chrome://adblockplus/content/filterClasses.js"></script>
  <script type="application/x-javascript;version=1.8" src="chrome://adblockplus/content/elemhide.js"></script>

  <script type="application/x-javascript;version=1.8">
    var prefs = {
      enabled: true
    };

    function tests()
    {
      function checkMatch(filters, expected)
      {
        for each (let filter in filters)
          elemhide.add(Filter.fromText(filter));

        elemhide.apply();
        let result = window.getComputedStyle(document.getElementById("test1"), "").display + " " + window.getComputedStyle(document.getElementById("test2"), "").display;

        writeResult(filters.join("\n"), result, expected);
        elemhide.clear();
      }

      if (compareGeckoVersion("1.9") >= 0)
      {
        checkMatch([], "block block");
        checkMatch(["#div(test1)"], "block block");
        checkMatch(["adblockplus#div(test1)"], "none block");
        checkMatch(["adblockplus#div(test1)", "foo,foo2#div(test2)"], "none block");
        checkMatch(["adblockplus,foo#div(test1)", "foo,adblockplus#div(test2)"], "none none");
        checkMatch(["adblockplus#div(test1)", "adblockplus#div(test2)"], "none none");
        checkMatch(["foo#div(test1)", "foo#div(test2)"], "block block");
      }
      else
      {
        writeResult("These tests require an application based on Gecko 1.9 or higher");
      }
    }
  </script>
</head>
<body>
  <div style="display: none;">
    <div id="test1"></div>
    <div id="test2"></div>
  </div>
</body>
</html>